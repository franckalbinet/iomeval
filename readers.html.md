# Readers


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

**Components:**

- [`EvalReader`](https://franckalbinet.github.io/iomeval/readers.html#evalreader):
  Base interface for all repository readers
- [`IOMRepoReader`](https://franckalbinet.github.io/iomeval/readers.html#iomreporeader):
  Reads IOM evaluation CSV exports from
  [evaluation.iom.int/evaluation-search-pdf](https://evaluation.iom.int/evaluation-search-pdf)
- [`load_evals`](https://franckalbinet.github.io/iomeval/readers.html#load_evals):
  Loads processed evaluation JSON files

**Purpose:**

Transform diverse evaluation data sources into a consistent format for
downstream analysis and processing.

The
[`EvalReader`](https://franckalbinet.github.io/iomeval/readers.html#evalreader)
interface defines a common contract that all evaluation repository
readers (e.g. IOM, UNHCR) must implement:

## Core Reader Interface

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L17"
target="_blank" style="float:right; font-size:smaller">source</a>

### EvalReader

>  EvalReader (cfg:dict)

*Initialize self. See help(type(self)) for accurate signature.*

<table>
<colgroup>
<col style="width: 9%" />
<col style="width: 38%" />
<col style="width: 52%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>cfg</td>
<td>dict</td>
<td>Configuration dict with field mappings and processing rules</td>
</tr>
</tbody>
</table>

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L29"
target="_blank" style="float:right; font-size:smaller">source</a>

### iom_input_cfg

>  iom_input_cfg ()

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L50"
target="_blank" style="float:right; font-size:smaller">source</a>

### Evaluation

>  Evaluation (id:str, docs:list, meta:dict)

*An evaluation with rich notebook display*

## IOM Reader

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L73"
target="_blank" style="float:right; font-size:smaller">source</a>

### IOMRepoReader

>  IOMRepoReader (fname:pathlib.Path)

*Initialize self. See help(type(self)) for accurate signature.*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>fname</td>
<td>Path</td>
<td>Path to the CSV export file</td>
</tr>
</tbody>
</table>

The `read` method loads the raw CSV data from the IOM repository export:

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L84"
target="_blank" style="float:right; font-size:smaller">source</a>

### IOMRepoReader.read

>  IOMRepoReader.read ()

``` python
fname = 'files/test/evaluation-search-export-11_13_2025--18_09_44.csv'
reader = IOMRepoReader(fname)
reader.read().iloc[0]
```

    Title                                       EVALUATION OF IOM’S MIGRATION DATA STRATEGY
    Year                                                                               2025
    Author                                                              Data Conscious Ltd.
    Best Practicesor Lessons Learnt                                                     Yes
    Date of Publication                                                          2025-08-11
    Donor                                                                               NaN
    Evaluation Brief                                                                    Yes
    Evaluation Commissioner                                                             IOM
    Evaluation Coverage                                                              Global
    Evaluation Period From Date                                                  2025-08-20
    Evaluation Period To Date                                                    2025-05-31
    Executive Summary                                                                   Yes
    External Version of the Report                                                       No
    Languages                                                                       English
    Migration Thematic Areas                                 Organisational policy/strategy
    Name of Project(s) Being Evaluated                                                  NaN
    Number of Pages Excluding annexes                                                  44.0
    Other Documents Included                                                            NaN
    Project Code                                                                        NaN
    Countries Covered                                                             Worldwide
    Regions Covered                                                               HQ Geneva
    Relevant Crosscutting Themes                                                        NaN
    Report Published                                                                    Yes
    Terms of Reference                                                                  Yes
    Type of Evaluation Scope                                                       Strategy
    Type of Evaluation Timing             Mid-term (during the project's implementation/...
    Type of Evaluator                                                              External
    Level of Evaluation                                                         Centralized
    Document Subtype                      Evaluation report, Special related reports/doc...
    File URL                              https://evaluation.iom.int/sites/g/files/tmzbd...
    File description                      Evaluation Report, Evaluation Brief, Annex VI ...
    Management response                                                                  No
    Date added                                                      Thu, 08/07/2025 - 23:52
    Name: 0, dtype: object

Each evaluation needs a unique identifier. Since the CSV doesn’t include
one, we generate an MD5 hash from key fields:

``` python
reader = IOMRepoReader(fname)
df_test = reader.read()
eval_id = reader._mk_id(df_test.iloc[0])
test_eq(len(eval_id), 32)
test_eq(eval_id, '9992310969aa2f428bc8aba29f865cf3')
```

IOM evaluations can have multiple associated documents (reports, briefs,
annexes). The CSV stores these as comma-separated values in three
parallel fields. We parse and combine them into structured document
records:

## Document Handling

``` python
reader = IOMRepoReader(fname)
df_test = reader.read()
reader._mk_docs(df_test.iloc[0])
```

    [{'subtype': 'Evaluation report',
      'url': 'https://evaluation.iom.int/sites/g/files/tmzbdl151/files/docs/resources/Annex%20VI%20Case%20Study%20-%20RDH%20East%2C%20Horn%20and%20Southern%20Africa.pdf',
      'desc': 'Evaluation Report'},
     {'subtype': 'Special related reports/documents',
      'url': 'https://evaluation.iom.int/sites/g/files/tmzbdl151/files/docs/resources/Annex%20VII%20Case%20Study%20-%20RDH%20Asia-Pacific.pdf',
      'desc': 'Evaluation Brief'}]

## Data Processing

``` python
reader = IOMRepoReader(fname)
df_test = reader.read()
df_proc = reader._proc_dates(df_test)
test_eq(df_proc['Date of Publication'].dtype, 'object')
test_eq(df_proc['Evaluation Period From Date'].dtype, 'object')
test_eq(df_proc['Evaluation Period To Date'].dtype, 'object')
df_proc['Date of Publication'].iloc[0]
```

    '2025-08-11'

``` python
reader = IOMRepoReader(fname)
df_test = reader.read()
df_proc = reader._proc_lists(df_test)
test_eq(type(df_proc['Countries Covered'].iloc[190]), list)
df_proc['Countries Covered'].iloc[190]
```

    ['Colombia']

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L135"
target="_blank" style="float:right; font-size:smaller">source</a>

### IOMRepoReader.tfm

>  IOMRepoReader.tfm (df:pandas.core.frame.DataFrame)

*Transform raw dataframe to evaluation objects*

``` python
reader = IOMRepoReader(fname)
evals = reader()
evals[0]
```

### EVALUATION OF IOM’S MIGRATION DATA STRATEGY

**Year:** 2025 | **Organization:** IOM | **Countries:** Worldwide

**Documents:** 2 available  
**ID:** `9992310969aa2f428bc8aba29f865cf3`

Finally, `to_json` runs the full pipeline and saves the results:

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L144"
target="_blank" style="float:right; font-size:smaller">source</a>

### IOMRepoReader.to_json

>  IOMRepoReader.to_json (out_path:pathlib.Path)

``` python
reader = IOMRepoReader(fname)
out_path = Path('files/test/iom_evals_test.json')
reader.to_json(out_path)
out_path.exists()
```

    True

To use the reader:

``` python
reader = IOMRepoReader(fname)
evaluations = reader()
```

The reader produces a list of JSON objects, where each object represents
an evaluation with:

- `id`: A unique MD5 hash identifier generated from specified fields
- `docs`: A list of associated documents, each containing:
  - `Document Subtype`: Type of evaluation document (e.g. report, brief)
  - `File URL`: Direct link to download the document
  - `File description`: Brief description of the document contents
- `meta`: Additional metadata about the evaluation

Then serialize as `json` for further use:

``` python
reader.to_json('files/test/evaluations.json')
```

## Utilities

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L153"
target="_blank" style="float:right; font-size:smaller">source</a>

### load_evals

>  load_evals (json_file)

*Load evaluations from JSON file*

``` python
fname = 'files/test/evaluations.json'
evals = load_evals(fname)
evals[0]
```

### EVALUATION OF IOM’S MIGRATION DATA STRATEGY

**Year:** 2025 | **Organization:** IOM | **Countries:** Worldwide

**Documents:** 2 available  
**ID:** `9992310969aa2f428bc8aba29f865cf3`

## Find eval by title or url

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L158"
target="_blank" style="float:right; font-size:smaller">source</a>

### in_docs

>  in_docs (ev:__main__.Evaluation, url:str)

*Check if a URL is in the documents of an evaluation*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>ev</td>
<td>Evaluation</td>
<td>Evaluation object</td>
</tr>
<tr>
<td>url</td>
<td>str</td>
<td>URL of an evaluation report</td>
</tr>
</tbody>
</table>

``` python
url = "https://evaluation.iom.int/sites/g/files/tmzbdl151/files/docs/resources/AAP%20Evaluation%20Report_final_.pdf"
fname = 'files/test/evaluations.json'
evals = load_evals(fname)
ev = first(evals.filter(lambda x: x.id == '6c3c2cf3fa479112967612b0baddab72'))

test_eq(in_docs(ev, url), True)
test_eq(in_docs(ev, "https://fake.url/nothere.pdf"), False)
```

------------------------------------------------------------------------

<a
href="https://github.com/franckalbinet/iomeval/blob/main/iomeval/readers.py#L166"
target="_blank" style="float:right; font-size:smaller">source</a>

### find_eval

>  find_eval (evals:list, query:str, by:str='title')

*Find evaluation by title or URL*

<table>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>evals</td>
<td>list</td>
<td></td>
<td>List of evaluations</td>
</tr>
<tr>
<td>query</td>
<td>str</td>
<td></td>
<td>Title or URL of evaluation</td>
</tr>
<tr>
<td>by</td>
<td>str</td>
<td>title</td>
<td>‘title’ or ‘url’</td>
</tr>
</tbody>
</table>

``` python
title = 'Evaluation of IOM Accountability to Affected Populations'
url = "https://evaluation.iom.int/sites/g/files/tmzbdl151/files/docs/resources/AAP%20Evaluation%20Report_final_.pdf"
test_eq(find_eval(evals, title, by='title').id, '6c3c2cf3fa479112967612b0baddab72')
test_eq(find_eval(evals, url, by='url').id, '6c3c2cf3fa479112967612b0baddab72')
test_eq(find_eval(evals, 'Nonexistent Title', by='title'), None)
test_eq(find_eval(evals, 'https://fake.url/nowhere.pdf', by='url'), None)
```

``` python
find_eval(evals, title, by='title')
```

### Evaluation of IOM Accountability to Affected Populations

**Year:** 2025 | **Organization:** IOM | **Countries:** Worldwide

**Documents:** 4 available  
**ID:** `6c3c2cf3fa479112967612b0baddab72`
